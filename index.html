<!DOCTYPE html>

<html lang="zh-CN">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
		<link href="img/flag.ico" rel="shortcut icon">
		<title style="text-align: center">>>古蜀文化博物馆数字化联动<<</title>
		<style type="text/css">
			a:link{font-size:20pt;}
		</style>
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/app.css" />
	</head>
	
	<body class="bg01">
		<header class="header">
			<h3>古蜀博物馆数字化联动</h3>
		</header>
		
		<div class="wrapper">
			<div class="container-fluid">
				<div class="row fill-h">
					<div class="col-lg-3 fill-h">
						<div class="xpanel-wrapper xpanel-wrapper-2">
							<div class="xpanel">
								<!-- 地图飞线 -->
								<div class="fill-h" id="flyMap"></div>
							</div>
						</div>
						<div class="xpanel-wrapper xpanel-wrapper-2">
							<div class="xpanel">
								<!-- 地图导引线 -->
								<!-- <div class="fill-h" id="lineMap"></div> -->
								<marquee direction="up" scrollamount="5" width=100% height=90% id="scroll">
									<font color="white" size="4"><b>
										蜀文化是一种地域文化概念，<br/>专指以成都平原、岷江流域为中心的源远流长、独具特色的区域文化。 <br/>蜀文化从本质上说是一种内陆农业文化。<br/>

望丛祠，位于四川省成都市郫都区西南部，<br/>距成都市区23千米。<br/>是为了纪念最早的蜀王望帝杜宇和他的继任人丛帝而修建的祀祠，<br/>也是中国西南地区唯一的一祠祭二主、凭吊蜀人先贤的最大的帝王陵冢。<br/>
1985年，望丛祠被列为成都市重点文物保护单位。<br/>1991年，被公布为四川省文物保护单位。<br/>1993年被授予“郫县青少年爱国主义教育基地

温江鱼凫村古城，四川成都平原上的史前城址。<br/>城址位于温江区万春乡鱼凫村,当地老百姓传说是古蜀王鱼凫的都邑所在地,习称“鱼凫城”。<br/>平面为不规则多边形，面积约32万平方米。<br/>

十二桥遗址位于四川省成都市蜀都大道十二桥路18号，<br/>是商代晚期至秦汉时期遗址。<br/>该遗址范围东西长约142米、南北宽约133米，总面积约15000平方米。<br/>十二桥遗址以商代大型宫殿式木结构建筑和小型干栏式木结构建筑群为特征。<br/>
十二桥遗址1985年被发掘，1986年至1989年，进行了第二次发掘。<br/>十二桥遗址是唯一可以见到桩柱和地梁基础以上遗存的早期干栏式建筑遗址，<br/>也是成都平原较早发现的一个商周时期的大型聚落遗址。<br/>
2001年6月25日，十二桥遗址被中华人民共和国国务院公布为第五批全国重点文物保护单位。<br/>

三星堆遗址位于中国四川省广汉市西北的鸭子河南岸，<br/>南距成都40公里，东距广汉市区7公里，<br/>是一座由众多古文化遗存分布点所组成的庞大的遗址群。<br/>由其内三个起伏相连的黄土堆而得名，有“三星伴月”的美名。<br/>遗址年代为公元前2800年至公元前1000年，<br/>文化遗存分为四期，出土的文物精品以数百件青铜器为主，<br/>国宝级文物有青铜立人像、青铜神树等。<br/>

芒城遗址：位于四川省成都市都江堰市青城山镇芒城村6组，<br/>为一处新石器时代城址，距今4500-4300年左右，<br/>2001年定级为都江堰市的全国重点文物保护单位。<br/>
郫县古城址：位于郫县三道堰镇古城村，<br/>是成都平原多处史前城址中保存最为完好的一处遗址。<br/>遗址长约650米，宽约500米，总面积32万平方米，<br/>属新石器时代晚期，距今有4000年左右的历史。<br/>1996年古城遗址与成都平原其它吏前城址被评为全国十大考古发现之一。<br/>1997年大规模考古发掘中又发现了全国同时期最大的礼仪性建筑遗迹，<br/>国内外数十家新闻单位进行了报道，<br/>引起了文物考古和史学界的极大关注。
扬雄墓：在郫都区城西南11公里三元场友爱镇。<br/>墓为圆形，高数米，直径10米，封土若小丘。<br/>墓地开旷，东西有农舍竹林环抱。<br/>墓前里许竹林间，为子云亭旧址。

									</b></font>
								</marquee>

							</div>
						</div>
					</div>
					<div class="col-lg-6 fill-h">
						<div class="xpanel-wrapper xpanel-wrapper-1">
							<div class="xpanel">
								<!-- 地图散点 -->
								<div class="fill-h" id="cdMap"></div>
							</div>
						</div>
					</div>
					<div class="col-lg-3 fill-h">
						<div class="xpanel-wrapper xpanel-wrapper-2">
							<div class="xpanel">
								<text><font color="#6495ed">
									其他文本
								</font></text>
							</div>
						</div>
						<div class="xpanel-wrapper xpanel-wrapper-2">
							<div class="xpanel">
								<iframe width=100% height=100% frameborder="0" src="updates.html"></iframe>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="js/echarts-3.8.5.min.js"></script>
		<script type="text/javascript" src="js/echarts-map-world.js"></script>
		<script type="text/javascript" src="js/echarts-map-china.js"></script>
		<script type="text/javascript" src="js/si4_chuan1_cheng2_du1.js"></script>
		<!--
		<script type="text/javascript" src="js/echarts-china-provinces/jiangsu.js"></script>
		<script type="text/javascript" src="js/echarts-china-cities/jiang1_su1_su1_zhou1.js"></script>
		<script type="text/javascript" src="js/echarts-china-counties/jiang1su1_su1zhou1_kun1shan1shi4.js"></script>
		-->
		<script type="text/javascript">
			$(function() {
				/******************* 地图飞线 ******************/
				//初始化echarts实例
				const flyMap = echarts.init(document.getElementById("flyMap"));
		        //城市经纬度
		        const originName = '成都';
		        const flyGeo = {
		        	'成都':[104.07, 30.66],'西南交通大学':[103.99, 30.77],'河海大学':[118.77, 32.06],'沈阳药科大学':[123.45, 41.77],'成都信息工程大学':[104.00, 30.59],'四川大学':[104.09, 30.64],'西南医科大学':[105.45, 28.89],'浙江工业大学':[120.05, 30.23],'苏州大学':[120.65, 31.31],'海南大学':[110.34, 20.06],'西南财经大学':[104.02, 30.67],'兰州大学':[103.87, 36.05],'天津理工大学':[117.15, 39.07],'西华师范大学':[106.07, 30.82],'南京航空航天大学':[118.83, 32.04],'天津工业大学':[117.12, 39.07],'川北医学院':[106.09, 30.80],'南开大学':[117.18, 39.11],'中国政法大学':[116.36, 39.97],'太原理工大学':[112.53, 37.87],'中国农业大学':[116.36, 40.01],'天津大学':[117.33, 39.01],'华东理工大学':[121.43, 31.15],'西交利物浦大学':[120.75, 31.28],'电子科技大学':[103.94, 30.76],'华中师范大学':[114.37, 30.52],'重庆医科大学':[106.51, 29.54],'中国人民警察大学':[116.67, 39.54],'大连医科大学':[121.32, 38.81],'新疆医科大学':[87.59, 43.84],'四川农业大学':[103.87, 30.71],'西北工业大学':[108.92, 34.25],'山东财经大学':[117.08, 36.65],'上海工程大学':[121.21, 31.06],
		        };
		        //飞线数据
		        var flyVal = [
		        		[{name:'成都'}, {name:'成都', value:49}],[{name:'西南交通大学'}, {name:'成都', value:2}],[{name:'河海大学'}, {name:'成都', value:1}],[{name:'沈阳药科大学'}, {name:'成都', value:1}],[{name:'成都信息工程大学'}, {name:'成都', value:1}],[{name:'四川大学'}, {name:'成都', value:5}],[{name:'西南医科大学'}, {name:'成都', value:2}],[{name:'浙江工业大学'}, {name:'成都', value:1}],[{name:'苏州大学'}, {name:'成都', value:2}],[{name:'海南大学'}, {name:'成都', value:1}],[{name:'西南财经大学'}, {name:'成都', value:1}],[{name:'兰州大学'}, {name:'成都', value:1}],[{name:'天津理工大学'}, {name:'成都', value:1}],[{name:'西华师范大学'}, {name:'成都', value:1}],[{name:'南京航空航天大学'}, {name:'成都', value:1}],[{name:'天津工业大学'}, {name:'成都', value:2}],[{name:'川北医学院'}, {name:'成都', value:1}],[{name:'南开大学'}, {name:'成都', value:1}],[{name:'中国政法大学'}, {name:'成都', value:1}],[{name:'太原理工大学'}, {name:'成都', value:1}],[{name:'中国农业大学'}, {name:'成都', value:1}],[{name:'天津大学'}, {name:'成都', value:1}],[{name:'华东理工大学'}, {name:'成都', value:1}],[{name:'西交利物浦大学'}, {name:'成都', value:1}],[{name:'电子科技大学'}, {name:'成都', value:4}],[{name:'华中师范大学'}, {name:'成都', value:1}],[{name:'重庆医科大学'}, {name:'成都', value:1}],[{name:'中国人民警察大学'}, {name:'成都', value:1}],[{name:'大连医科大学'}, {name:'成都', value:1}],[{name:'新疆医科大学'}, {name:'成都', value:1}],[{name:'四川农业大学'}, {name:'成都', value:1}],[{name:'西北工业大学'}, {name:'成都', value:1}],[{name:'山东财经大学'}, {name:'成都', value:1}],[{name:'上海工程大学'}, {name:'成都', value:1}],
		        ];
		        //数据转换，转换后格式：[{fromName:'cityName', toName:'cityName', coords:[[lng, lat], [lng, lat]]}, {...}]
		        const convertFlyData = function(data) {
		            let res = [];
		            for(let i=0;i<data.length;i++) {
		                let dataItem = data[i];
		                let toCoord = flyGeo[dataItem[0].name];
		                let fromCoord = flyGeo[dataItem[1].name];
		                if(fromCoord && toCoord) {
		                    res.push({
		                        fromName: dataItem[1].name, 
		                        toName: dataItem[0].name, 
		                        coords: [fromCoord, toCoord]
		                    });
		                }
		            }
		            return res;
		        };
		        //报表配置
		        const flySeries = [];
		        [[originName, flyVal]].forEach(function(item, i) {
					flySeries.push({   
				        name: item[0],
				        type: 'lines',
				        zlevel: 1,
				        symbol: ['none', 'none'],
				        symbolSize: 0,
				        effect: { //特效线配置
				            show: true,
				            period: 5, //特效动画时间，单位s
				            trailLength: 0.1, //特效尾迹的长度，从0到1
				            symbol: 'arrow',
				            symbolSize: 5
				        },
				        lineStyle: {
				            normal: {
				                color: '#f19000',
				                width: 1,
				                opacity: 0.6,
				                curveness: 0.2 //线的平滑度
				            }
				        },
				        data: convertFlyData(item[1])
				    }, {
				        name: item[0],
				        type: 'effectScatter',
				        coordinateSystem: 'geo',
				        zlevel: 2,
				        rippleEffect: { //涟漪特效
				            period: 5, //特效动画时长 
				            scale: 4, //波纹的最大缩放比例
				            brushType: 'stroke' //波纹的绘制方式：stroke | fill
				        },
				        label: {
				            normal: {
				                show: false,
				                position: 'right',
				                formatter: '{b}'
				            }
				        },
				        symbol: 'circle',
				        symbolSize: function (val) {
				        	//根据某项数据值设置符号大小
				            return val[2] / 10; 
				        },
				        itemStyle: {
				            normal: {
				            	color: '#f19000'
				            }
				        },
				        data: item[1].map(function(dataItem) {
				            return {
				                name: dataItem[1].name,
				                value: flyGeo[dataItem[1].name].concat([dataItem[1].value])
				            };
				        })
				    }, { //与上层的点叠加
				    	name: item[0],
				        type: 'scatter',
				        coordinateSystem: 'geo',
				        zlevel: 3,
				        symbol: 'circle',
				        symbolSize: function (val) {
				        	//根据某项数据值设置符号大小
				            return val[2] / 15; 
				        },
				        itemStyle: {
				            normal: {
				            	color: '#f00'
				            }
				        },
				        data: item[1].map(function(dataItem) {
				            return {
				                name: dataItem[1].name,
				                value: flyGeo[dataItem[1].name].concat([dataItem[1].value])
				            };
				        })
				    });
		        });
	
				//报表配置项
				const flyMapOpt = {
					title: {
						show: true,
						text: '飞线示意',
						x: 'center',
						textStyle: {
							color: '#fff'
						}
					},
	                tooltip: {
	                    trigger: 'item',
	                    formatter: function(params) {
	                        if(params.value) {
	                            return params.name + ' : ' + params.value[2];
	                        }else {
	                            return params.name;
	                        }
	                    }
	                },
				    geo: {
				        map: 'china',
				        roam: false, //开启鼠标缩放和漫游
				        zoom: 1, //地图缩放级别
						selectedMode: false, //选中模式：single | multiple
						left: 0,
						right: 0,
						top: 0,
						bottom: 0,
						layoutCenter: ['50%', '50%'], //设置后left/right/top/bottom等属性无效
						layoutSize: '100%', //保持地图宽高比
				        label: {
				            emphasis: {
				                show: false
				            }
				        },
				        itemStyle: {
				            normal: {
				                areaColor: '#101f32',
				                borderWidth: 1.1,
				                borderColor: '#43d0d6'
				            },
				            emphasis: {
				                areaColor: '#069'
				            }
				        }
				    },
				    series: flySeries
				};
				//渲染报表
				flyMap.setOption(flyMapOpt);
				
				/***************** 地图散点 ******************/
				//初始化echarts实例
				//const scatterMap = echarts.init(document.getElementById("scatterMap"));
				//城市经纬度
				const scatterGeo = {
					"望丛祠":[103.88, 30.82],"温江鱼凫古城":[103.82, 30.70],"十二桥遗址":[104.05, 30.67],"三星堆遗址":[104.21, 31.00],"芒城古城址":[103.61, 30.89],"郫县古城址":[103.93, 30.91],"扬雄墓":[103.78, 30.84],
				};
				//城市数据
				const scatterVal = [
						{name:"望丛祠", value:"望丛二帝陵墓，古蜀文化发源"},{name:"温江鱼凫古城", value:"古蜀王鱼凫的都城所在地"},{name:"十二桥遗址", value:"较早发现的商周时期的聚落遗址"},{name:"三星堆遗址", value:"众多古蜀文化遗存组成的庞大遗址群"},{name:"芒城古城址", value:"宝墩文化城址群"},{name:"郫县古城址", value:"古蜀文化聚落遗址"},{name:"扬雄墓", value:"大儒杨雄的陵墓"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},{name:"nan", value:"nan"},
				];
				//数据转换，转换后的格式：[{name: 'cityName', value: [lng, lat, val]}, {...}]
				const convertScatterData = function(data) {
				    let res = [];
				    for(let i=0;i<data.length;i++) {
				        let geoCoord = scatterGeo[data[i].name];
				        if(geoCoord) {
				            res.push({
				                name: data[i].name,
				                value: geoCoord.concat(data[i].value)
				            });
				        }
				    }
				    return res;
				};
				//地图配置项
				/*const sactterMapOpt = {
					title: {
						text: '同学去向',
						x: 'center',
						textStyle: {
							color: '#fff'
						}
					},
					legend: {
						data: ['各校名单'], //与series的name属性对应
				        orient: 'vertical',
				        y: 'bottom',
				        x: 'right',
				        textStyle: {
				            color: '#fff'
				        }
				    },
					tooltip: {
				        trigger: 'item',
				        formatter: function(params) {
				            return params.name + ' : ' + params.value[2];
				        }
				    },
					geo: {
				        map: 'china',
				        roam: true, //开启鼠标缩放和漫游
				        zoom: 1, //地图缩放级别
						selectedMode: false, //选中模式：single | multiple
						left: 0,
						right: 0,
						top: 0,
						bottom: 0,
						layoutCenter: ['50%', '50%'], //设置后left/right/top/bottom等属性无效
						layoutSize: '100%',
				        label: {
				            emphasis: {
				                show: false
				            }
				        },
				        itemStyle: {
				            normal: {
				                areaColor: '#101f32',
				                borderWidth: 1.1,
				                borderColor: '#43d0d6'
				            },
				            emphasis: {
				                areaColor: '#069'
				            }
				        }
				    },
				    series: [{
			            name: 'student',
			            type: 'scatter',
			            coordinateSystem: 'geo',
			            symbolSize: 12,
			            label: {
			                normal: {
			                    show: false
			                },
			                emphasis: {
			                    show: false
			                }
			            },
			            itemStyle: {
			                emphasis: {
			                    borderColor: '#fff',
			                    borderWidth: 1
			                }
			            },
			            data: convertScatterData(scatterVal)
			        }]
				};
				//渲染报表
				scatterMap.setOption(sactterMapOpt);//初始化echarts实例*/
				/***************** 成都散点 ******************/
				const cdMap = echarts.init(document.getElementById("cdMap"));
				//地图配置项
				const sactterMapOptcd = {
					title: {
						text: '成都分布',
						x: 'center',
						textStyle: {
							color: '#fff'
						}
					},
					legend: {
						data: ['各校名单'], //与series的name属性对应
				        orient: 'vertical',
				        y: 'bottom',
				        x: 'right',
				        textStyle: {
				            color: '#fff'
				        }
				    },
					tooltip: {
				        trigger: 'item',
				        formatter: function(params) {
				            return params.name + ' : ' + params.value[2];
				        }
				    },
					geo: {
				        map: '成都',
				        roam: false, //开启鼠标缩放和漫游
				        zoom: 3, //地图缩放级别
						selectedMode: false, //选中模式：single | multiple
						left: 0,
						right: 0,
						top: 0,
						bottom: 0,
						layoutCenter: ['50%', '50%'], //设置后left/right/top/bottom等属性无效
						layoutSize: '100%',
				        label: {
				            emphasis: {
				                show: false
				            }
				        },
				        itemStyle: {
				            normal: {
				                areaColor: '#101f32',
				                borderWidth: 1.1,
				                borderColor: '#43d0d6'
				            },
				            emphasis: {
				                areaColor: '#069'
				            }
				        }
				    },
				    series: [{
			            name: 'scatter',
			            type: 'scatter',
			            coordinateSystem: 'geo',
			            symbolSize: 9,
			            label: {
			                normal: {
			                    show: false
			                },
			                emphasis: {
			                    show: false
			                }
			            },
			            itemStyle: {
			                emphasis: {
			                    borderColor: '#fff',
			                    borderWidth: 1
			                }
			            },
			            data: convertScatterData(scatterVal)
			        }]
				};
				//渲染报表
				cdMap.setOption(sactterMapOptcd);


				/******************* 引导地图 ******************/
				//初始化echarts实例
				/*const lineMap = echarts.init(document.getElementById('lineMap'));

				var seriesData = [];
				seriesData.push({
					name: '大学',
					type: 'scatter',
					coordinateSystem: 'geo',
					data: convertScatterData(scatterVal),
					label: {
						normal: {
							show: false,
							padding: [10, 20],
							color: '#fff',
							areaColor: '#4ed5a4',
							background_color: '#00A2FF',
							borderRadius: 12,
							formatter: '{b}'
						},
						emphasis: {
							show: true
						}
					},
					symbolSize: 3
				});
				seriesData.push({
					type: 'lines',
					symbol: 'circle',
					symbolSize: [10, 10],
					color: '#ff8003',
					opacity: 1,
					label: {
						show: false,
						padding: [10, 20],
						color: '#fff',
						background_color: '#00A2FF',
						borderRadius: 6,
						formatter: '{b}'
					},
					lineStyle: {
						type: 'solid',
						opacity: 1,
						color: '#fff'
					},
					data: [
						{name: 'test', value: [103.9, 30.7, '侯智航'], coords:[[103.993214, 30.770399], [116.669141, 39.537844]]}
					]
				});
				var lineMapOpt = {
					title: {
						text: '导线示意图',
						x: 'center',
						textStyle: {
							color: '#fff'
						}
					},
					tooltip: {
						show: true,
						trigger: 'item',
						formatter: function(params) {
				            return params.name + ' : ' + params.value[2];
				        }
					},
					geo: {
						map: 'china',
						label: {
							normal: {
								show: false
							},
							emphasis: {
								show: false
							}
						},
						zoom: 0.8,
				        itemStyle: {
				            normal: {
				                areaColor: '#101f32',
				                borderWidth: 1.1,
				                borderColor: '#43d0d6'
				            },
				            emphasis: {
				                areaColor: '#069'
				            }
				        }
					},
					series: seriesData
				}
				lineMap.setOption(lineMapOpt);*/
				/********** 浏览器窗口改变时，重置报表大小 ****************/
				window.onresize = function() {
					flyMap.resize();
					//scatterMap.resize();
					cdMap.resize();
					//worldMap.resize();
					provinceMap.resize();
					cityMap.resize();
					countyMap.resize();
				}
			});
		</script>
	</body>
</html>